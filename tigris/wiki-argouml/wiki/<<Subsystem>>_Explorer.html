<h1><small>From the ArgoUML wiki at argouml.tigris.org.</small><br />         Wiki: &lt;&lt;Subsystem&gt;&gt; Explorer
    </h1>
</div>
 
 
 
        
                 
                 
           
    
  

 
 





<div class="wiki">




<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><dl><dt>Purpose</dt><dd>to provide tree views of the model elements, diagrams and other objects.  <span class="anchor" id="line-2"></span></dd><dt>Located</dt><dd><p class="line891"><tt>org.argouml.ui.explorer</tt> and sub-packages <span class="anchor" id="line-3"></span></dd><dt>Layer</dt><dd><p class="line891"><a href="&lt;&lt;Layer&gt;&gt;_View_and_Control_subsystems.html">&lt;&lt;Layer&gt;&gt; View and Control subsystems</a> <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span></dd></dl><p class="line867"><img alt="/!\" height="15" src="../branding/css/wiki/cee/img/alert.png" title="/!\" width="15" /> The Explorer used to be called the Navigator. <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line867">
<h2 id="head-17b0bd4d4bb20dd70ea0b5d789c6070a1e4c953c">Design of the subsystem</h2>
<span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line867">
<h3 id="head-0ffc4b87bab7798085cd9737e7035321e931c8ed">Requirements</h3>
<span class="anchor" id="line-10"></span><p class="line874">The Explorer must react to user and application events. <span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><p class="line874">User events include <span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><p class="line874">R1: selection of a node, which must notify the other views to make the same selection. <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><p class="line874">R2: right click on a node, which brings up a pop-up menu. <span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><p class="line874">R3: selection of another perspective in the Combo box, which must change the explorer to that perspective. A perspective provides a different view of the model that will focus on one or other part of the model. <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><p class="line874">R4: node expansion and collapse. <span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><p class="line874">R5: It is possible to drag name-space nodes on to other name-space nodes. Dropping a name-space node onto another, will, if the destination name-space is a valid one, update the explorer and model. <span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><p class="line874">R6: sorting of nodes with a particular Ordering. [an ordering is a comparator that orders child nodes in the explorer, e.g. by name and/or type]. <span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><p class="line874">R7: copy diagram to clipboard functionality for windows/java5 users. <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><p class="line874">R8: tool-tip showing node name and type. <span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><p class="line874">R9: standard multiple discontinuous selection with mouse and keyboard. <span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><p class="line874">R10: the user can configure the perspectives using a dialog. Perspectives can be added, deleted, renamed, reordered and duplicated. Perspective rules can be added and removed from a perspective. The changes are saved to the user properties. If there are user perspectives when ArgoUML starts, it loads these, otherwise it loads a default set of perspectives. <span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><p class="line874">Application events include <span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><p class="line874">R11: change in selection in another view, any relevant rows to be highlighted. <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><p class="line874">R12: the UML model changes, the tree must update to reflect additions/deletions and name changes in the model. <span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><p class="line874">R13: change of project, the tree must update. the root node should be expanded with the default diagram selected. <span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><p class="line867">
<h3 id="head-fcf9c729bc538df632a42f5febed169c96f6ba97">Public APIs and SPIs</h3>
<span class="anchor" id="line-45"></span><p class="line874">The Explorer Subsystem provides/will provide the following APIs: <span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><p class="line862">API1: Addition / Removal of a Perspective from the PerspectiveManager. Status: implemented <span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><p class="line874">API2: Addition / Removal of a Perspective Rule from a Perspective. Status: implemented <span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><p class="line874">API3: Selection of the Perspective to be displayed by the Explorer. Status: not implemented <span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><p class="line874">API4: Selection of Ordering for Explorer nodes. [an Ordering is a comparator that orders child nodes in the Explorer] Status: not implemented <span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><p class="line874">The Explorer Subsystem provides/will provide the following SPIs: <span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><p class="line874">SPI1: Configurable Node pop-up menu. Status: not implemented <span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><p class="line862">SPI2: New PerspectiveRules can be defined and registered with the 'library' of available rules. Status: not implemented <span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><p class="line874">SPI3: New Orderings can be defined and registered with the available orderings. [an ordering is a comparator that orders child nodes in the explorer] Status: not implemented <span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><p class="line874">The APIs collectively represent the Explorer subsystem facade and the SPIs represent plug-ins. <span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><p class="line867">
<h3 id="head-f85083e470371fa9a0b4628282802454bd582694">Details of the Explorer Implementation</h3>
<span class="anchor" id="line-68"></span><p class="line862">The Explorer is currently shown in the Explorer Pane (<tt>org.argouml.ui.NavigatorPane</tt>) - the upper left hand pane of ArgoUML. <span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><p class="line862">Except for the Explorer Pane, The Explorer is located in <tt>org.argouml.ui.explorer.*</tt>. The explorer has been refactored since version 0.15.2 so that it has a slightly more standard Java Swing implementation. <span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><p class="line862">The explorer perspectives provide the different views of the project. They are implemented by sets of PerspectiveRules that get the child nodes for any parent node in the tree. <span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><p class="line867"><img src="explorerclassdiagram.bmp" /> <span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><p class="line862">The Explorer has 3 main subcomponents: a customized <tt>JTree</tt>, a customized <tt>TreeModel</tt> and an interface for generating child nodes in the tree which forms the tree <tt>Perspective</tt>. <span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><p class="line862">The <tt>JTree</tt> (<tt>org.argouml.ui.explorer.ExplorerTree</tt>) has been customized to maintain consistent selection state with the other model views. It provides a pop up menu (<tt>ExplorerPopup</tt>) for performing actions on specific model elements. There is specific functionality in <tt>DnDExplorerTree</tt> for Drag and drop, and in <tt>ExportExplorer</tt> for copy diagram to clipboard. <span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><p class="line862">The <tt>TreeModel</tt> is a customized <tt>DefaultTreeModel</tt> that listens to changes in the UML model. The <tt>JTree</tt> builds the tree model as the user expands nodes, this minimizes the size of the model to those part that the user is interested in. The <tt>TreeModel</tt> contains custom <tt>DefaultMutableTreeNode</tt>s, <tt>ExplorerTreeNode</tt>s, that maintain their own order on child nodes; this will typically be an alphabetical order on the model element names. However, it could be enhanced to include more powerful orders like total subtree size. <span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><p class="line862">The model uses the third part of the <tt>Explorer</tt> design, <tt>PerspectiveRule</tt>s, to add child nodes to the leaves of the tree. The structure of the tree is wholly dependent on the collection of <tt>PerspectiveRule</tt>s that together provide a specialized view of the UML model. This is very flexible and extensible. The <tt>org.argouml.ui.explorer.rules</tt> package contains a default set of <tt>PerspectiveRule</tt>s. <span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><p class="line862">Each node is displayed with a name and an Icon, representing the type of node it is in the UML model. This is done using the <tt>org.argouml.uml.ui.UMLTreeRenderer</tt> (for the <tt>Icon</tt>), and the text is produced in the <tt>convertValueToText(...)</tt> method in <tt>org.argouml.ui.explorer.ExplorerTree</tt>. <span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><p class="line867">
<h3 id="head-7f4e5e6a58374c46486f8f041d83f5d90ead135f">How do I ...?</h3>
<span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><p class="line874">...add another perspective? <span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><p class="line862">The perspectives can be configured using the <tt>org.argouml.ui.explorer.PerspectiveConfigurator</tt> by the User. The changes to the pre-defined built-in defaults are stored in the <strong>argo.user.properties</strong> file. <span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><p class="line862">If you want to do this as part of an extension to ArgoUML then you should use (see above) APIs 1,2 and 3, and SPI 2. The functions needed are present in the <tt>PerspectiveManager</tt>. <span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><p class="line862">...improve the PopUp menu? <span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><p class="line874">There is no way of doing this currently without modifying the core of ArgoUML. You could use SPI1 when it gets implemented. <span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><p class="line862">...extend the <tt>Explorer</tt> in other ways? <span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><p class="line874">The best way is to use the above APIs/SPIs; if they are not implemented then it would be best to implement them and feedback your improvements to the ArgoUML project so that your code works on a recognized public API that will be maintained in the future. <span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span><p class="line874">...add new rules for new model elements? <span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><p class="line862">You should create a <tt>GoRule</tt>/<tt>PerspectiveRule</tt> in <strong>org/argouml/ui/explorer/rules</strong>. There are plenty of examples to look at. The important things to get right is of course that: <span class="anchor" id="line-109"></span><span class="anchor" id="line-110"></span><ul><li>you return the right children <span class="anchor" id="line-111"></span></li><li style="list-style-type:none"><p class="line862">return the objects that the TreeModel must listen to to know when to update the node (and the list of immediate children) After that you must register your GoRule in org/argouml/ui/explorer/PerspectiveManager <span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span></li><li class="gap">add it to the list in loadRules() <span class="anchor" id="line-114"></span></li><li style="list-style-type:none"><p class="line862">perhaps add it to some of the default perspectives in <tt>oldLoadDefaultPerspectives()</tt>, I guess And then I think it should just be a matter of recompiling and possibly switching to the perspective you added your rule to. <span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span></li></ul><p class="line874">...tell the explorer to refresh? <span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span><p class="line862">You are not supposed to. The TreeModel is supposed to listen to events and refresh affected parts. And this is where the lack of events for adding diagrams creates a problem. <span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><p class="line874">Obviously it would be possible to add an operation somewhere to revalidate the expanded parts of the Explorer, but I'm not aware of the existence of such an operation today. <span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><p class="line874">...navigate programmatically to a certain explorer element so that its path is exploded? <span class="anchor" id="line-124"></span><span class="anchor" id="line-125"></span><p class="line862">In general you can't. The Explorer tree is lazy in that it only explores the parts of the tree that the user has opened. And since the GoRules are general navigating to them would require a complete tree search. Which is also complicated by the fact that the answer is not unique and there can be branches with infinite depth. <span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span><p class="line874">In reality it would be possible to create an algorithm to search out one occurrence of an element (since the model only contains finitely many elements and I assume that no-one will add go rules that add branches of infinite length that does not infinitely often contain elements from the model), but I don't think anyone has done it. Obviously finding all occurrences cannot be done. <span class="anchor" id="line-128"></span><hr /><p class="line874"> <span class="anchor" id="line-129"></span><a href="CategoryFromCookbook.html">CategoryFromCookbook</a> <span class="anchor" id="line-130"></span><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">&lt;&lt;Subsystem&gt;&gt; Explorer  (last edited 2009-02-08 10:20:07 -0700 by <span title="Linus Tolke @ localhost[127.0.0.1]"><a href="linus.html" title="Linus Tolke @ localhost[127.0.0.1]">linus</a></span>)</p>

